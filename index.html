<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-90773148-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>Learn2Proåšå®¢ç²¾é€‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="DL,ML,SPARK,GRAPH">
<meta property="og:type" content="website">
<meta property="og:title" content="Learn2Proåšå®¢ç²¾é€‰">
<meta property="og:url" content="http://learn2pro.tech/index.html">
<meta property="og:site_name" content="Learn2Proåšå®¢ç²¾é€‰">
<meta property="og:description" content="DL,ML,SPARK,GRAPH">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="learn">
<meta name="twitter:card" content="summary">
<meta property="fb:admins" content="100023269004018">
  
    <link rel="alternate" href="https://github.com/learn2pro" title="Learn2Proåšå®¢ç²¾é€‰" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!-- Calendly badge widget begin -->
  <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
  <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript"></script>
  <script type="text/javascript">Calendly.initBadgeWidget({ url: 'https://calendly.com/druidlangde/mock-interview', text: 'Schedule time with me', color: '#00a2ff', textColor: '#ffffff', branding: true });</script>
  <!-- Calendly badge widget end -->
<meta name="generator" content="Hexo 4.2.1"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Learn2Proåšå®¢ç²¾é€‰</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Learn2Pro</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="https://github.com/learn2pro" target="_blank" rel="noopener" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://learn2pro.tech"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-infra-design" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/22/infra-design/" class="article-date">
  <time datetime="2020-07-22T01:28:40.000Z" itemprop="datePublished">2020-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/22/infra-design/">æˆ‘çœ¼ä¸­å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¯ç”¨ç³»ç»Ÿ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="ç³»ç»Ÿå®šä½"><a href="#ç³»ç»Ÿå®šä½" class="headerlink" title="ç³»ç»Ÿå®šä½"></a>ç³»ç»Ÿå®šä½</h2><p>ä¸€ä¸ªç³»ç»Ÿæ˜ç¡®ä¹‹åˆï¼Œå°±åº”è¯¥å®šä¹‰å®ƒè®¾è®¡çš„ç›®æ ‡ï¼Œæ¯”å¦‚ç°æœ‰çš„å¾ˆå¤šå¤§å‹ç”µå•†ç³»ç»Ÿï¼Œå¯ç”¨æ€§æ˜¯å®ƒè®¾è®¡çš„ç›®æ ‡ï¼Œå…¨å¹´è¦è¾¾åˆ°5ä¸ª9ï¼Œè€Œå¾ˆå¤šé“¶è¡Œç³»ç»Ÿè¦æ±‚å¾ˆå¼ºçš„äº‹åŠ¡æ€§ï¼Œé‚£å¼ºä¸€è‡´å°±æ˜¯å…¶è®¾è®¡ç›®æ ‡ï¼Œä¿è¯ä¸èƒ½é”™ï¼›è¿˜æœ‰ä¸€äº›ç³»ç»Ÿéœ€è¦å¾ˆä½çš„å»¶è¿Ÿç­‰ï¼›å®šä¹‰å¥½æˆ‘ä»¬ç³»ç»Ÿçš„ç›®æ ‡åï¼Œå›´ç»•è¿™äº›ä¸œè¥¿å¯ä»¥æœ‰å¾ˆå¤šè®¾è®¡ç†å¿µå¯ä»¥è¿ç”¨ï¼›</p>
<h2 id="é«˜å¯ç”¨ç³»ç»Ÿ"><a href="#é«˜å¯ç”¨ç³»ç»Ÿ" class="headerlink" title="é«˜å¯ç”¨ç³»ç»Ÿ"></a>é«˜å¯ç”¨ç³»ç»Ÿ</h2><p>é«˜å¯ç”¨ç³»ç»Ÿè®¾è®¡ä¸Šï¼Œé¦–å…ˆå®šä¹‰å¥½æˆ‘ä»¬å¯ç”¨ç‡çš„ç›®æ ‡ï¼Œæ¯”å¦‚æ˜¯99.999%ï¼Œè¡¨ç¤ºå…¨é‡æœ€å¤šä¸å¯ç”¨5åˆ†é’Ÿï¼Œæœ‰äº†æŒ‡æ ‡åï¼Œæˆ‘ä»¬å°±è¦æ‹†åˆ†ä¸‹å¦‚ä½•å¦‚ä½•è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œå› ä¸ºå¤§éƒ¨åˆ†ç³»ç»Ÿè‚¯å®šä¸èƒ½è‡ªå·±é—­ç¯ï¼Œä½ è¦ä¾èµ–å¤–éƒ¨æœåŠ¡ï¼Œdbï¼Œmqç­‰ï¼›</p>
<ol>
<li>å¼ºä¾èµ–ï¼ˆå…¸å‹çš„åç«¯çš„dbï¼Œæˆ–è€…ä¸å¯æˆ–ç¼ºçš„å¤–éƒ¨æœåŠ¡ï¼‰</li>
<li>å¼±ä¾èµ–ï¼ˆå¿å—å®¹é”™ï¼Œå¯ä»¥è¢«é™çº§æ‰ï¼‰</li>
</ol>
<p>æ•´ä½“æœåŠ¡çš„å¯ç”¨ç‡å°±å¯ä»¥è®¡ç®—å‡ºæ¥äº†ï¼Œ<em>å‡è®¾å¼ºä¾èµ–ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„</em><br>$$<br>self * \prod_{dependencies}availability = 0.9999 * \prod_{dependencies} 0.9999 = 0.9997<br>$$<br>å¯ä»¥çœ‹å‡ºè¦è¾¾åˆ°æœ€ç»ˆçš„ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦æå‡è‡ªå·±ï¼Œæˆ–è€…å¼ºä¾èµ–ï¼›è¿˜æœ‰ä¸€äº›æƒ…å†µæ˜¯å½“æˆ‘ä»¬ä¸çŸ¥é“å¯¹æ–¹çš„SLAæ—¶ï¼Œå¦‚ä½•é¢„ä¼°è¿™ä¸ªå€¼æ¥å¸®åŠ©æˆ‘ä»¬è®¾è®¡ç³»ç»Ÿï¼Œæ­¤æ—¶ä¼šç”¨åˆ°ä¸¤ä¸ªæŒ‡æ ‡æ¥é¢„ä¼°ï¼›</p>
<ul>
<li>Mean Time Between Failure (MTBF)</li>
<li>Mean Time to Recover (MTTR)<br>$$<br>Availability Estimate = MTBF / (MTBF + MTTR)<br>$$<br>æ¯”å¦‚MTBF=150daysï¼ŒMTTR=1hourï¼Œæˆ‘ä»¬å¯ä»¥é¢„ä¼°ä¸€ä¸ªå¯ç”¨ç‡æ˜¯99.97%ï¼Œæœ‰äº†ä»¥ä¸Šæ•°æ®æ”¯æ’‘åï¼Œéœ€è¦æŠ€æœ¯ä¸Šåšä¸€äº›äº‹æƒ…æ¥æ”¯æ’‘ï¼Œå¯ç”¨ç‡çš„æå‡ï¼Œç®€å•æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š<h3 id="å®¹é‡ç®¡ç†"><a href="#å®¹é‡ç®¡ç†" class="headerlink" title="å®¹é‡ç®¡ç†"></a>å®¹é‡ç®¡ç†</h3>æˆ‘ä»¬éœ€è¦å¾ˆæ¸…æ¥šè‡ªå·±çš„ç³»ç»Ÿï¼ŒçŸ¥é“ä»–åœ¨ä¸åŒèµ„æºä¸‹çš„æ°´ä½,å¦‚ä½•è®¾è®¡ç³»ç»Ÿé™æµç­‰<h3 id="ç½‘ç»œç®¡ç†"><a href="#ç½‘ç»œç®¡ç†" class="headerlink" title="ç½‘ç»œç®¡ç†"></a>ç½‘ç»œç®¡ç†</h3>ä½ éœ€è¦æ¸…æ¥šè‡ªå·±æœåŠ¡çš„éƒ¨ç½²æƒ…å†µï¼Œæ˜¯å¦ä¼šæœ‰è·¨æœºæˆ¿çš„é€šä¿¡ï¼Œç½‘ç»œå»¶è¿Ÿæ˜¯æ€æ ·çš„ï¼Œæ˜¯å¦ä¼šå¯¼è‡´å †ç§¯ï¼Œå¦‚ä½•å¤„ç†Dosï¼Œå¦‚ä½•åšLoad Balance,ç½‘ç»œçš„FOç­‰<h3 id="æœåŠ¡ç®¡ç†"><a href="#æœåŠ¡ç®¡ç†" class="headerlink" title="æœåŠ¡ç®¡ç†"></a>æœåŠ¡ç®¡ç†</h3>å°†è‡ªèº«æœåŠ¡æŒ‰ç…§æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€è¿›è¡Œæ‹†åˆ†ï¼Œå› ä¸ºä½ çš„ä¸šåŠ¡ç‰¹ç‚¹ï¼Œå¯èƒ½ä¼šé¢ä¸´æ¯æ—¶æ¯åˆ»çš„å³°å€¼å˜æ¢ï¼Œè¦èƒ½æ–¹ä¾¿çš„scale-out<h3 id="Isolation"><a href="#Isolation" class="headerlink" title="Isolation"></a>Isolation</h3>æœ‰äº†ç‹¬ç«‹çš„Replicaä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾è‘—çš„æå‡å¯ç”¨ç‡ï¼Œå®ƒçš„è®¡ç®—æ¨¡å¼å˜ä¸ºäº†ï¼š<br>$$<br>self * \prod_{dependencies}not/availability = 0.9999 * \prod_{dependencies} 0.001 = 0.9997<br>$$<br><code>level0</code>:æˆ‘ä»¬éœ€è¦äº’ç›¸ç‹¬ç«‹çš„available zoneæ¥æä¾›æœåŠ¡ï¼Œæ–¹ä¾¿åŸºç¡€è®¾æ–½å‡ºç°é—®é¢˜åè¿›è¡Œåˆ‡æ¢<br><code>level1</code>:å…³é”®æ€§çš„æ¨¡å—æ”¯æŒå‰¯æœ¬ï¼Œæå‡è¿™äº›æ¨¡å—çš„å¯ç”¨ç‡ï¼Œé¿å…ä¸€äº›å•ç‚¹é—®é¢˜<h3 id="å®¹ç¾ç®¡ç†"><a href="#å®¹ç¾ç®¡ç†" class="headerlink" title="å®¹ç¾ç®¡ç†"></a>å®¹ç¾ç®¡ç†</h3>è®¾è®¡çš„ç›®æ ‡æ˜¯å‡ºç°æ•…éšœåï¼Œå¦‚ä½•ç¼©çŸ­æ¢å¤çš„æ—¶é—´ï¼Œæ¢³ç†ä¸šåŠ¡çš„é¢„æ¡ˆï¼Œå‡ºç°é—®é¢˜åavailable zoneçš„åˆ‡æ¢æ–¹æ¡ˆï¼Œå…³é”®æ¨¡å—çš„åˆ‡æ¢æ–¹æ¡ˆï¼Œæˆ–è€…èƒ½ä¸èƒ½åšåˆ°è‡ªåŠ¨åŒ–çš„FO<br>ï¼›æ¢³ç†ä¸»é“¾è·¯ï¼Œä¸€äº›å¼±ä¾èµ–å‡ºç°é—®é¢˜èƒ½å¦ç›´æ¥é™çº§æ‰ï¼Œå‡ä½é£é™©;å®¹ç¾ä¹Ÿéœ€è¦ç»å¸¸æµ‹è¯•ï¼Œå› ä¸ºä¸åŒåœºæ™¯çš„åˆ‡æ¢ï¼Œå¯èƒ½å¯¼è‡´æµé‡è¶…è¿‡æŸä¸ªzoneçš„æ‰¿è½½æé™ï¼Œæœ€å¥½èƒ½æ”¯æŒå¿«é€Ÿçš„auto-scaling;<h3 id="å˜æ›´ç®¡ç†"><a href="#å˜æ›´ç®¡ç†" class="headerlink" title="å˜æ›´ç®¡ç†"></a>å˜æ›´ç®¡ç†</h3>ç³»ç»Ÿå‡ºç°é—®é¢˜çš„æƒ…å†µå¾ˆå¤šéƒ½æ˜¯ç”±äºå˜æ›´(éƒ¨ç½²ï¼Œçƒ­å˜æ›´)ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦éµå¾ªä¸€äº›å˜æ›´çš„best practice:<br><code>ç°åº¦å‘å¸ƒ</code>ï¼Œå°æ‰¹é‡å¤šæ¬¡è¿›è¡Œå‘å¸ƒï¼Œå‡å°‘å½±å“èŒƒå›´<br><code>è“ç»¿å‘å¸ƒ</code>ï¼Œæ•´ä¸ªå‘å¸ƒåˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼Œå½“ä¸€ä¸ªéƒ¨åˆ†å‡ºç°é—®é¢˜ï¼Œå¯ä»¥FOåˆ°å¦å¤–éƒ¨åˆ†ï¼Œç„¶åå¿«é€Ÿå›æ»šï¼Œè¿›è¡Œæ¢å¤<br><code>åŠŸèƒ½å¼€å…³</code>ï¼Œæ–°åŠŸèƒ½ä¸Šçº¿çš„æ—¶å€™é»˜è®¤æŠŠå¼€å…³å…³é—­ï¼Œå°‘é‡æ‰“å¼€ç¡®è®¤æ— é—®é¢˜åï¼Œæ‰å…¨é‡æ”¾å¼€<br><code>æµ‹è¯•</code>ï¼ŒåŒ…æ‹¬ä»£ç éƒ¨åˆ†çš„å•æµ‹ï¼Œé›†æˆæµ‹è¯•ï¼›ä¸Šçº¿åçš„ç°åº¦æµ‹è¯•ç­‰ï¼›æµ‹è¯•éœ€è¦è¦†ç›–æ­£å¸¸å’Œå¼‚å¸¸çš„æƒ…å†µ<h3 id="ç›‘æ§-amp-æŠ¥è­¦"><a href="#ç›‘æ§-amp-æŠ¥è­¦" class="headerlink" title="ç›‘æ§&amp;æŠ¥è­¦"></a>ç›‘æ§&amp;æŠ¥è­¦</h3>æˆ‘ä»¬éœ€è¦å¯¹ç³»ç»Ÿæœ‰æ·±å…¥ä¸”å®æ—¶çš„äº†è§£ï¼Œä»¥ä¾¿åšå‡ºæ­£ç¡®çš„åº”å¯¹</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2020/07/22/infra-design/" data-id="ckf12d0e8000azgk0ccalbwv3" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Infra/" rel="tag">Infra</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ali-learn" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/18/ali-learn/" class="article-date">
  <time datetime="2020-07-18T03:46:27.000Z" itemprop="datePublished">2020-07-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Essay/">Essay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/18/ali-learn/">Wonderful tour in alibaba</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å³å°†ä»é˜¿é‡Œæ¯•ä¸šäº†ï¼Œå› ä¸ºå„ç§å„æ ·çš„åŸå› ï¼Œé€‰æ‹©äº†ç¦»å¼€ï¼›å¾ˆæ„Ÿè°¢è¿™æ¥è¿‘ä¸‰å¹´çš„ç»å†ï¼Œå¿™ç¢Œè€Œå……å®ï¼›åœ¨è¿™æ ·çš„ç¯å¢ƒä¸­å­¦åˆ°äº†å¾ˆå¤šï¼Œå¦‚æœç”¨<br>ä¸¤ä¸ªå­—æ€»ç»“æ˜¯<code>æ„Ÿæ©</code>ï¼Œæ„Ÿæ©åŒäº‹(ä¸æ–¹ä¾¿å†™åå­—äº†ã€‚ã€‚ã€‚)ï¼Œæ„Ÿæ©è¿™é‡Œçš„å¹³å°ï¼Œå¦‚æœä½ ä¹Ÿå‡†å¤‡å»é˜¿é‡Œï¼Œæˆ‘æƒ³è®²è®²ä½ å¯èƒ½è¦å…³æ³¨çš„ä¸€äº›äº‹æƒ…ï¼</p>
<h2 id="æˆ‘åœ¨é˜¿é‡Œå­¦åˆ°çš„ä¸€äº›äº‹"><a href="#æˆ‘åœ¨é˜¿é‡Œå­¦åˆ°çš„ä¸€äº›äº‹" class="headerlink" title="æˆ‘åœ¨é˜¿é‡Œå­¦åˆ°çš„ä¸€äº›äº‹"></a>æˆ‘åœ¨é˜¿é‡Œå­¦åˆ°çš„ä¸€äº›äº‹</h2><ol>
<li>è¦æœ‰ä¼šæŠ˜è…¾çš„å¿ƒæ€ï¼Œå³ä½¿å¼€å§‹çœ‹èµ·æ¥ä¸æ€ä¹ˆé è°±ï¼Œè·¯æ˜¯è¶Šèµ°è¶Šé¡ºçš„</li>
<li>å­¦ä¼šæ²Ÿé€šå¾ˆé‡è¦ï¼Œèƒ½å¿«é€Ÿæå‡ä½ çš„è®¤çŸ¥ï¼Œäººç±»æœ‰äº†è¯­è¨€ä»¥åï¼Œæ‰å»ºç«‹èµ·äº†ç»Ÿæ²»åœ°ä½</li>
<li>è¦ç”¨å–„æ„çš„çœ¼å…‰å»çœ‹äººçœ‹äº‹ï¼Œè¿™æ ·å¹²èµ·æ¥æ‰æ›´æœ‰åŠ¨åŠ›</li>
<li>åƒé‡Œé©¬å¸¸æœ‰ï¼Œè€Œä¼¯ä¹ä¸å¸¸æœ‰ï¼Œä¸€ä¸ªé€‚åˆä½ çš„å›¢é˜Ÿè‡³å…³é‡è¦</li>
<li>è¦æœ‰ç©ºæ¯çš„å¿ƒæ€ï¼Œè¿™å¾ˆé‡è¦ï¼Œå…¶ä»–èƒ½åŠ›éƒ½å¯ä»¥å¿«é€Ÿè¡¥é½</li>
<li>è¦å–„äºä½¿ç”¨å¹³å°ï¼Œä½†ä¹Ÿè¦è®¤è¯†åˆ°æå‡ä¸ªäººèƒ½åŠ›æ‰æ˜¯æœ€é‡è¦çš„ï¼Œæƒ³æƒ³ç¦»å¼€å¹³å°ä½ è¿˜æœ‰äº›ä»€ä¹ˆ</li>
<li>æ²Ÿé€šæœ€é‡è¦çš„æ˜¯èƒ½æ­£ç¡®çš„ä¼ é€’ä¿¡æ¯ï¼Œæ‰€ä»¥ä½ æ˜¯è¦æœ‰æ‰€å‡†å¤‡çš„,è¡¥é½ä¸€äº›è®¤çŸ¥è¯¯å·®ï¼Œæ‰èƒ½æå‡æ²Ÿé€šæ•ˆç‡</li>
<li>è¦å­¦ä¼šåœ¨é˜¿é‡Œç”Ÿå­˜ï¼Œä½ å°±è¦æœ‰è‡ªå·±çš„é—ªå…‰ç‚¹ï¼Œå¦‚ä½•æ‰“é€ è‡ªå·±çš„åç‰‡ï¼Œå¾ˆå…³é”®</li>
<li>äººç»ˆæœ‰ä¸€æ­»ï¼Œæ—¢ç„¶ç»ˆç‚¹éƒ½ä¸€æ ·ï¼Œæ›´åº”è¯¥çœ‹é‡çš„æ˜¯è¿‡ç¨‹</li>
<li>writing as thinking,å¾ˆå¤šäº‹æƒ…æƒ³ä¸æ¸…æ¥šå¯ä»¥å†™ä¸‹æ¥ï¼Œè¿™ä¸€è¿‡ç¨‹ä½ ä¼šæ…¢ä¸‹æ¥ï¼Œæ¸æ¸å°±æ¸…æ™°äº†</li>
<li>äººåœ¨æ³¢æ¾œä¸æƒŠä¸­æ˜¯ä¸ä¼šæˆé•¿çš„ï¼Œç”¨é˜¿é‡ŒåœŸè¯è®²ï¼Œé€ƒç¦»è‡ªå·±çš„èˆ’é€‚åŒº</li>
<li>äººç”Ÿä¸ä¼šæœ‰å€’è½¦çš„æœºä¼šï¼Œæ‰€ä»¥ä½ éœ€è¦å‘å‰çœ‹ï¼Œåªè¦æœç€ç›®æ ‡ï¼Œåªæ˜¯è·¯ç¨‹è¿œè¿‘çš„é—®é¢˜</li>
<li>ç«™åœ¨æœªæ¥çš„è§†è§’çœ‹ç°åœ¨çš„è¡Œä¸ºï¼Œå¤šå°‘æ˜¯åœ¨ä¸»èˆªé“ä¸Šçš„ï¼Œkeep going</li>
</ol>
<h2 id="æœªæ¥"><a href="#æœªæ¥" class="headerlink" title="æœªæ¥"></a>æœªæ¥</h2><ol>
<li>æœªæ¥æ˜¯ä¸ç¡®å®šçš„ï¼Œå”¯ä¸€ä¸å˜çš„æ˜¯ï¼Œæˆ‘åº”è¯¥ä¼šæŒç»­ä¸æ–­çš„æŠ˜è…¾ğŸ˜</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2020/07/18/ali-learn/" data-id="ckf12d0e30005zgk00qrr7gda" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/default/" rel="tag">default</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-manachers-algorithm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/18/manachers-algorithm/" class="article-date">
  <time datetime="2020-07-18T01:06:41.000Z" itemprop="datePublished">2020-07-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/18/manachers-algorithm/">ä»€ä¹ˆæ˜¯é©¬æ‹‰è½¦(manacher&#39;s)ç®—æ³•</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨è®¡ç®—æœºä¸–ç•Œé‡Œï¼Œæœ‰ä¸€ç±»é—®é¢˜å«å¯»æ‰¾å›æ–‡å­ä¸²ï¼Œè‹±æ–‡å«<code>Palindrome</code>ï¼Œè¿™ä¸ªé—®é¢˜åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œäººä»¬éƒ½æ²¡æ‰¾åˆ°æ¯”è¾ƒé«˜æ•ˆçš„ç®—æ³•<br>ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½åœ¨<code>O(n^2)</code>ï¼Œä¸‹é¢æ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯å›é—®å­—ç¬¦ä¸²ï¼š<br><img src="/image/manacher/palindrome_substr.svg" alt="å›æ–‡ä¸²"><br>å¯ä»¥çœ‹åˆ°æ•´ä¸ªå­—ç¬¦ä¸²æ˜¯å¯¹ç§°çš„ï¼Œå°†<code>sub</code>åè½¬è¿‡æ¥è¿˜æ˜¯ç­‰äºå®ƒè‡ªèº«ï¼Œå­—ç¬¦ä¸²çš„part0å’Œpart1æ˜¯å¯¹ç§°çš„ï¼ŒåŸºäºè¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥å†™å‡º<br>ä¸€ä¸ª<code>O(n^2)</code>çš„ç®—æ³•ï¼›</p>
<h2 id="Intuition"><a href="#Intuition" class="headerlink" title="Intuition"></a>Intuition</h2><p>ç›´æ¥æ¯”è¾ƒå‰åéƒ¨åˆ†ï¼Œä½†æ˜¯è¦åˆ¤æ–­å¥‡å¶çš„æƒ…å†µ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPalindromeNum</span><span class="params">(s:str)</span>-&gt;int:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> s : <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    size,ans = len(s),<span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">helper</span><span class="params">(start,end)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> start&gt;=<span class="number">0</span> <span class="keyword">and</span> end&lt;size <span class="keyword">and</span> s[start]==s[end]:</span><br><span class="line">            ans += <span class="number">1</span></span><br><span class="line">            start -= <span class="number">1</span></span><br><span class="line">            end += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(size):</span><br><span class="line">        helper(i,i)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(size):</span><br><span class="line">        helper(i,i+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªç®—æ³•æœ‰ä¸¤å±‚å¾ªç¯ï¼Œå¤–å±‚æ˜¯O(n),å†…å±‚æœ€åæƒ…å†µä¹Ÿæ˜¯O(n),æ‰€ä»¥æ•´ä¸ªç®—æ³•å¤æ‚åº¦æ˜¯O(n^2),é‡Œé¢ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œæˆ‘ä»¬è¿›è¡Œäº†å¾ˆå¤š<br>é‡å¤çš„æ¯”è¾ƒï¼Œè¿™æ—¶å€™å°±è¦å¼•å…¥manacherâ€™sç®—æ³•äº†ï¼Œä»–èƒ½å¤Ÿå¤ç”¨æˆ‘ä»¥å‰æ¯”è¾ƒçš„ç»“æœ</p>
<h2 id="manacherâ€™s"><a href="#manacherâ€™s" class="headerlink" title="manacherâ€™s"></a>manacherâ€™s</h2><ul>
<li>ä¸€å¼€å§‹æƒ³è¿™ä¸ªé—®é¢˜æˆ‘ä¹Ÿè¯•è¿‡åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯åˆ©ç”¨äºŒä½æ•°ç»„dp[i][j] = dp[i+1][j-1] + 2 if str[i] == str[j]ï¼›åˆ©ç”¨ä»¥å‰<br>åˆ¤æ–­è¿‡çš„å›æ–‡ä¸²æ¥è¿­ä»£ï¼Œä½†æ˜¯æ•´ä¸ªç®—æ³•å¤æ‚åº¦è¿˜æ˜¯O(n^2),å› ä¸ºæˆ‘dp[i][j]æ— æ³•åˆ©ç”¨dp[i][j-1]çš„ä¿¡æ¯ï¼Œmanacherç”¨äº†å¦å¤–ä¸€ä¸ªæ€è·¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼›</li>
<li>ç®—æ³•ä¸­æœ‰å‡ ä¸ªå˜é‡éœ€è¦å®šä¹‰:<ul>
<li>center,å½“å‰æœ€é•¿å›æ–‡å­ä¸²çš„ä¸­å¿ƒåæ ‡index</li>
<li>right,å½“å‰æœ€é•¿å›æ–‡å­ä¸²çš„å³è¾¹ç•Œåæ ‡index</li>
<li>radiusæ•°ç»„,è®°å½•å­—ç¬¦ä¸²æ¯ä¸€ä¸ªä½ç½®çš„æœ€é•¿å›æ–‡å­ä¸²åŠå¾„</li>
<li>mirror_i,æˆ‘å½“å‰ä½ç½®å¤„äºiï¼Œä»¥centerä¸ºä¸­å¿ƒï¼Œæˆ‘çš„å¯¹ç§°ä½ç½®ä¸ºmirror_i=2*center-i</li>
</ul>
</li>
</ul>
<p><img src="/image/manacher/manacher_alg.svg" alt="é©¬æ‹‰è½¦"><br>ä¸€å¥è¯è§£é‡Šï¼šå½“æˆ‘è¦è®¡ç®—iä½ç½®çš„å›æ–‡å­ä¸²æ—¶ï¼Œæˆ‘ä¼šå»çœ‹mirror_iä½ç½®çš„å›æ–‡å­ä¸²é•¿åº¦ï¼Œå› ä¸ºmirror_içš„å›æ–‡å­ä¸²ä¼šæ ¹æ®centerå¯¹ç§°<br>åˆ°iä½ç½®ï¼Œæ‰€ä»¥mirror_iåŠå¾„ä»¥å†…çš„å­—ç¬¦éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œè¿­ä»£æ—¶ä¼šè·³è¿‡è¿™ä¸€éƒ¨åˆ†ï¼›è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜æ˜¯éœ€è¦è€ƒè™‘è¾¹ç•Œrightï¼Œå› ä¸ºå¦‚æœmirror_i<br>çš„åŠå¾„è¶…è¿‡äº†mirror_i,æˆ‘ä»¬åªèƒ½èµ·å§‹ç‚¹å¡åœ¨rightï¼Œå› ä¸ºå¦‚æœè¶…è¿‡rightéƒ¨åˆ†æ˜¯å¯¹ç§°çš„ï¼Œå½“å‰centerçš„åŠå¾„è‚¯å®šä¸æ˜¯rightè¿™ä¸ªä½ç½®ï¼Œç®—æ³•<br>å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findPalindromeNum</span><span class="params">(s:str)</span>-&gt;int:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">manachers</span><span class="params">(input)</span>:</span></span><br><span class="line">        <span class="comment"># å±è”½å¥‡å¶é—®é¢˜</span></span><br><span class="line">        input = <span class="string">'!#'</span>+<span class="string">'#'</span>.join(input)+<span class="string">'#$'</span></span><br><span class="line">        center = right = <span class="number">0</span></span><br><span class="line">        radius = [<span class="number">0</span>] * len(input)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(input)):</span><br><span class="line">            <span class="keyword">if</span> i &lt; right:</span><br><span class="line">                <span class="comment"># è·å–å½“å‰è¦è¿›è¡Œè¿­ä»£çš„èµ·å§‹åŠå¾„</span></span><br><span class="line">                radius[i] = min(radius[<span class="number">2</span>*center - i],right - i)</span><br><span class="line">            <span class="comment"># è¿­ä»£è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">            <span class="keyword">while</span> input[i-radius[i]<span class="number">-1</span>] == input[i+radius[i]+<span class="number">1</span>]:</span><br><span class="line">                radius[i] += <span class="number">1</span></span><br><span class="line">            <span class="comment"># å¦‚æœå½“å‰å›æ–‡å­ä¸²è¾¹ç•Œå¤§äºå³è¾¹ç•Œï¼Œåˆ™æ›´æ–°</span></span><br><span class="line">            <span class="keyword">if</span> i+radius[i] &gt; right:</span><br><span class="line">                center,right = i,i + radius[i]</span><br><span class="line">        <span class="keyword">return</span> sum((size+<span class="number">1</span>)//<span class="number">2</span> <span class="keyword">for</span> size <span class="keyword">in</span> radius)</span><br><span class="line">    <span class="keyword">return</span> manachers(s)</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºç®—æ³•å®ç°ä¸æ˜¯æ¯æ¬¡éƒ½è·³åˆ°0å¼€å§‹æœç´¢ï¼Œè€Œæ˜¯è·³åˆ°äº†mirrorçš„radiusä¸Šå¼€å§‹æœç´¢ï¼Œå¯ä»¥è¯æ˜æ•´ä¸ªç®—æ³•æ—¶é—´å¤æ‚åº¦æ˜¯O(n)çš„ï¼›</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://dl.acm.org/doi/10.1145/321892.321896" target="_blank" rel="noopener">manancherâ€™s algorithm</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2020/07/18/manachers-algorithm/" data-id="ckf12d0ea000ezgk0h66i3ke0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-snowflake-alg" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/07/09/snowflake-alg/" class="article-date">
  <time datetime="2020-07-09T01:37:20.000Z" itemprop="datePublished">2020-07-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/07/09/snowflake-alg/">è¯¦è§£é›ªèŠ±ç®—æ³•</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>é›ªèŠ±ç®—æ³•è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹äº§ç”Ÿä¸€ä¸ªå”¯ä¸€çš„idï¼Œè€Œè¿™äº›å”¯ä¸€idåœ¨ä¸šåŠ¡æˆ–è€…æŠ€æœ¯ä¸Šéƒ½ä¼šæœ‰å¹¿æ³›ä½¿ç”¨ï¼Œ<br>æ¯”å¦‚è®¢å•å·ï¼Œä¸€æ¬¡è¯·æ±‚çš„requestIdï¼ŒtraceIdç­‰ï¼›ç°æœ‰çš„ä¸€äº›ç®—æ³•æ¯”å¦‚å¾®è½¯çš„UUIDï¼Œä»–èƒ½ä¿è¯å”¯ä¸€ï¼Œä½†æ˜¯é›ªèŠ±ç®—æ³•<br>ç›¸è¾ƒäºä»–æ›´æœ‰ä¼˜åŠ¿çš„ä¸€ç‚¹ï¼Œå®ƒèƒ½ä¿è¯æ•´ä½“é€’å¢ï¼Œè¿™å¯¹æˆ‘ä»¬ä¸šåŠ¡ç±»çš„idå¾ˆæœ‰ç”¨ï¼›å–åçš„å‡ºå¤„æ˜¯ï¼Œ<code>ä¸–ç•Œä¸Šæ‰¾ä¸åˆ°ä¸¤ç‰‡ç›¸åŒçš„
é›ªèŠ±</code>,åœ¨æˆ‘ä»¬rpcçš„æ¡†æ¶ä¸­ï¼Œä¹Ÿç”¨åˆ°äº†é›ªèŠ±ç®—æ³•æ¥ç”Ÿæˆrequest-id;</p>
<h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>é›ªèŠ±ç®—æ³•çš„IDå ç”¨64bitï¼Œå…¶ä¸­åˆ†åˆ«æœ‰ä¸åŒçš„å«ä¹‰ï¼Œç¬¬ä¸€ä½bitæ˜¯ç¬¦å·ä½ï¼Œå› ä¸ºæˆ‘ä»¬æ—¶é—´éƒ½æ˜¯æ­£çš„ï¼Œæ‰€ä»¥ä¸º0ï¼›åç»­41ä½ä¸º<br>æ—¶é—´ï¼Œæ¥ç€5ä½datacenterId+5ä½workerId,æœ€å12bitä½sequenceè¡¨ç¤ºå•æœºåœ¨åŒä¸€æ¯«ç§’å¯ä»¥äº§ç”Ÿçš„idæ•°é‡,æ‰€ä»¥èƒ½åˆ°å•æœº<code>400w</code>çš„å¹¶å‘<br><img src="/image/snow/snow_flake_id.svg" alt=""></p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><ol>
<li>ä»£ç å®ç°éå¸¸ç®€å•ï¼Œè€Œä¸”å•æœºéå¸¸é«˜æ•ˆ<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”¨æˆ·è‡ªå·±å®šä¹‰çš„ä¸šåŠ¡èµ·å§‹å€¼ï¼Œç›¸å½“äºmagic numçš„æ¦‚å¿µ</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">long</span> twepoch = <span class="number">1288834974657L</span>;</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">nextId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> timestamp = timeGen();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (timestamp &lt; lastTimestamp) &#123;</span><br><span class="line">        LOGGER.error(<span class="string">"clock is moving backwards.  Rejecting requests until &#123;&#125;."</span>, lastTimestamp);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">                <span class="string">"Clock moved backwards.  Refusing to generate id for "</span> + (lastTimestamp - timestamp) +</span><br><span class="line">                        <span class="string">" milliseconds"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (lastTimestamp == timestamp) &#123;</span><br><span class="line">        sequence = (sequence + <span class="number">1</span>) &amp; sequenceMask;</span><br><span class="line">        <span class="keyword">if</span> (sequence == <span class="number">0</span>) &#123;</span><br><span class="line">            timestamp = tilNextMillis(lastTimestamp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        sequence = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    lastTimestamp = timestamp;</span><br><span class="line">    <span class="keyword">return</span> ((timestamp - twepoch) &lt;&lt; timestampLeftShift) | (datacenterId &lt;&lt; datacenterIdShift) |</span><br><span class="line">            (workerId &lt;&lt; workerIdShift) | sequence;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2>é›ªèŠ±ç®—æ³•è¢«å¹¿æ³›çš„åº”ç”¨ï¼Œå½“ç„¶å·¥ä¸šçº§åˆ«çš„idç”Ÿæˆç®—æ³•è¿˜æœ‰å¾ˆå¤šï¼ŒåŒ…æ‹¬ç¾å›¢çš„<a href="https://github.com/Meituan-Dianping/Leaf" target="_blank" rel="noopener">leaf</a><br>ç™¾åº¦çš„<a href="https://github.com/baidu/uid-generator/blob/master/README.zh_cn.md" target="_blank" rel="noopener">UidGenerator</a><br>ç™¾åº¦ä½¿ç”¨æœªæ¥æ—¶é—´ï¼Œå­˜æ”¾åˆ°RingBufferä¸­ï¼Œå†æ¬¡æå‡é›ªèŠ±ç®—æ³•çš„å¹¶å‘åº¦ï¼Œèƒ½åˆ°å•æœº<code>600w</code></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2020/07/09/snowflake-alg/" data-id="ckf12d0eb000gzgk01chr54an" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-write-a-easy-rpc" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/09/write-a-easy-rpc/" class="article-date">
  <time datetime="2019-07-09T03:06:43.000Z" itemprop="datePublished">2019-07-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/09/write-a-easy-rpc/">Step by Stepå†™ä¸€ä¸ªç®€æ˜“çš„RPC</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨Cloud Nativeå¤§ç«çš„ä»Šå¤©ï¼Œæˆ‘ä»¬æƒ³æ¥è®²è®²åœ¨è¿™ä¸ªä½“ç³»ä¸‹æ¯”è¾ƒé‡è¦çš„ä¸œè¥¿RPC-framework,ä¸ºä»€ä¹ˆéœ€è¦æœ‰è¿™ä¸ªä¸œè¥¿å‘¢ï¼Œéœ€è¦æ¥è®²è®²å†å²äº†ï¼›<br>æœ€å¼€å§‹ä»£ç ç»„ç»‡çš„æ–¹å¼ï¼Œæœ€åŸå§‹å°±æ˜¯æ‰€æœ‰codeéƒ½åœ¨ä¸€ä¸ªrepoé‡Œé¢ï¼Œé«˜å†…èšæ¨¡å¼ï¼Œåœ¨ä¸šåŠ¡æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œè¿™æ²¡ä»€ä¹ˆé—®é¢˜ï¼ä½†æ˜¯åˆ°äº†ä¸šåŠ¡å¿«é€Ÿå‘å±•çš„æ—¶å€™å°±ä¼š<br>å¸¦æ¥è‡´å‘½çš„ç¼ºé™·äº†ï¼š</p>
<ol>
<li>æ•æ·æ€§<ol>
<li>codeå…¨éƒ¨å†™åœ¨ä¸€ä¸ªrepoé‡Œé¢ï¼Œå¯¼è‡´æ¯æ¬¡å¼€å‘/æµ‹è¯•/ä¸Šçº¿ï¼Œç¼–è¯‘ä¼šèŠ±å¾ˆå¤šæ—¶é—´</li>
<li>ä¸åŒæ¨¡å—é—´çš„ç›¸äº’å½±å“ï¼Œæ¯”å¦‚æ¨¡å—Aéœ€è¦ä¸Šçº¿ï¼Œä¾èµ–æ¨¡å—Bï¼Œæ¨¡å—Bç”±äºæ¯”è¾ƒå¤æ‚éœ€è¦å¾ˆå¤šæ—¶é—´è¿›è¡Œæµ‹è¯•ï¼Œå¯¼è‡´åŠŸèƒ½å¾ˆç®€å•çš„Aè¿­ä»£é€Ÿåº¦å¼ºä¾èµ–äºBï¼Œæ— æ³•éš”ç¦»</li>
</ol>
</li>
<li>æ‰©å±•æ€§<ol>
<li>ä¸åŒçš„æ¨¡å—ï¼Œæ‰¿è½½çš„ä¸šåŠ¡ä¸åŒï¼Œæ¨¡å—Aéœ€è¦å¾ˆå¤šæœºå™¨æ¥æ‰¿è½½æµé‡ï¼Œè€Œæ¨¡å—Bå´ä¸éœ€è¦è¿™ä¹ˆå¤šæœºå™¨ï¼Œå¯¼è‡´å¾ˆå¤šæ— ç”¨çš„codeè·‘åœ¨æœºå™¨ä¸Šå ç”¨èµ„æº</li>
<li>ä¸åŒæ¨¡å—çš„SLAè¦æ±‚ï¼Œä¸ä¸€æ ·ï¼Œä¸€ä¸ª999çš„æ¨¡å—å’Œä¸€ä¸ª99çš„æ¨¡å—æ”¾åœ¨ä¸€èµ·æ˜¾ç„¶ä¸åˆé€‚</li>
<li>ä¸åŒæ¨¡å—çš„å±æ€§ä¸åŒï¼Œæœ‰çš„æ¨¡å—æ— çŠ¶æ€ï¼Œå¯ä»¥æ°´å¹³æ‰©å®¹ï¼Œæœ‰çš„æ¨¡å—æœ‰çŠ¶æ€ï¼Œæ— æ³•æ°´å¹³æ‰©å®¹ï¼Œæ‰åœ¨ä¸€èµ·ï¼Œå¢åŠ å¤æ‚æ€§</li>
</ol>
</li>
</ol>
<p>ç°é˜¶æ®µçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå°†ä¸€æ•´å—çš„æ‹¼å›¾ï¼Œæ‰“ç¢ï¼Œåˆ’åˆ†ä¸ºï¼Œä¸€ä¸ªä¸ªç‹¬ç«‹çš„ä¸ªä½“ï¼Œä»–ä»¬ç›¸äº’ä¸å½±å“ï¼Œå„è‡ªè´Ÿè´£å¥½è‡ªå·±çš„äº‹æƒ…å³å¯ï¼Œå¼•å‡ºæ¥çš„æ¶æ„å«SOA(<code>S</code>ervice-<code>O</code>riented <code>A</code>rchitecture),<br>é‡Œé¢å¾ˆé‡è¦çš„ä¸€ä¸ªèƒ½åŠ›å°±æ˜¯æ”¯æŒï¼ŒæœåŠ¡é—´è°ƒç”¨ï¼Œèµ°è¿œç«¯çš„æ¨¡å¼å°±æ˜¯RPCï¼Œä¸‹é¢è®²è®²ï¼Œå¸¸è§RPCçš„æ¶æ„ä½“ç³»</p>
<h2 id="INFRA"><a href="#INFRA" class="headerlink" title="INFRA"></a>INFRA</h2><p>å¤§éƒ¨åˆ†çš„RPCä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯ï¼Œæ³¨å†Œä¸­å¿ƒ<br><img src="/image/rpc/easy_rpc.svg" alt=""></p>
<ul>
<li>å®¢æˆ·ç«¯<ul>
<li>å®¢æˆ·ç«¯ä¸»è¦æ˜¯æœåŠ¡çš„è°ƒç”¨æ–¹ï¼Œä»–æœ‰å‡ ç§operation:1.ä»æ³¨å†Œä¸­å¿ƒæ‹‰å»é…ç½® 2.å’ŒæœåŠ¡ç«¯å»ºç«‹è¿æ¥ 3.å‘æœåŠ¡ç«¯å‘èµ·request</li>
</ul>
</li>
<li>æ³¨å†Œä¸­å¿ƒ<ul>
<li>æ³¨å†Œä¸­å¿ƒä¸»è¦ç”¨æ¥ä¿å­˜æœåŠ¡çš„å…ƒæ•°æ®ï¼Œæ¯”å¦‚1.ç°åœ¨æœ‰å¤šå°‘ä¸ªservice 2.æ¯ä¸ªserviceçš„provideræœ‰å“ªäº› 3.æ£€æµ‹å­˜æ´»çš„provider 4.æä¾›é…ç½®ä¿¡æ¯ç»™å®¢æˆ·ç«¯</li>
</ul>
</li>
<li>æœåŠ¡ç«¯<ul>
<li>æœåŠ¡ç«¯æ˜¯serviceçš„æä¾›æ–¹ï¼Œä»–ä¸»è¦åš 1.å¯åŠ¨æœåŠ¡å¹¶æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ 2.å‘é€å¿ƒè·³ï¼Œè¯æ˜è‡ªå·±è¿˜æ´»ç€ 3.æä¾›channelæ¥æ”¶ç”¨æˆ·çš„request</li>
</ul>
</li>
</ul>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>æ¥ä¸‹æ¥æ˜¯å¹²æ´»ï¼Œæ•´ä¸ªrpcçš„å®ç°éƒ¨åˆ†ï¼Œè¿˜æ˜¯æŒ‰ç…§å®¢æˆ·ç«¯ï¼Œæ³¨å†Œä¸­å¿ƒï¼ŒæœåŠ¡ç«¯æ¥è®²ï¼Œ<br>æ•´ä¸ªrepo<code>https://github.com/learn2Pro/easyrpc</code> åœ¨æ­¤å¤„</p>
<ol>
<li>æ³¨å†Œä¸­å¿ƒ<ul>
<li>æ³¨å†Œä¸­å¿ƒçš„æ¥å£éƒ¨åˆ†ï¼Œæä¾›ä¸€ç³»åˆ—metaä¿¡æ¯çš„ç®¡ç†<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public interface RpcConfigServer &#123;</span><br><span class="line"> RemoteAddr sense(String service) throws Throwable;</span><br><span class="line"> void register(RemoteAddr addr, String service, Class&lt;?&gt; klass);</span><br><span class="line"> void unregister(RemoteAddr addr);</span><br><span class="line"> default CodecType fetchCodec() &#123;</span><br><span class="line">   return CodecType.JSON;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">ä¸»è¦æœ‰ä¸¤ç§å®ç°</span><br><span class="line">&#x2F;&#x2F;æœ¬åœ°æ³¨å†Œä¸­å¿ƒï¼ˆæµ‹è¯•ç”¨ï¼‰</span><br><span class="line">Class LocalConfigServer extends RpcConfigServer</span><br><span class="line">&#x2F;&#x2F;Zkæ³¨å†Œä¸­å¿ƒ</span><br><span class="line">Class ZkConfigServer extends RpcConfigServer</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>æœåŠ¡ç«¯<ul>
<li>æ³¨å†Œåˆ°config server<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProviderRepository</span> <span class="keyword">implements</span> <span class="title">Repository</span>, <span class="title">ApplicationContextAware</span>, <span class="title">InitializingBean</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">  <span class="comment">//å¯»æ‰¾provideræ³¨è§£ï¼Œå¹¶æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">registerProvider</span><span class="params">(ApplicationContext app)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : app.getBeansWithAnnotation(Provider<span class="class">.<span class="keyword">class</span>).<span class="title">entrySet</span>()) </span>&#123;</span><br><span class="line">      Class&lt;?&gt; klass = entry.getValue().getClass();</span><br><span class="line">      Provider ann = klass.getAnnotation(Provider<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">      String name =</span><br><span class="line">          StringUtils.isEmpty(ann.value()) ? StringUtils.uncapitalize(klass.getSimpleName())</span><br><span class="line">              : ann.value();</span><br><span class="line">      rpcConfigServer.register(RemoteAddr.local(), name, klass);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>å¯åŠ¨socketç«¯å£ç›‘å¬è¯·æ±‚ï¼Œä½¿ç”¨netty-io<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProviderRouter</span> <span class="keyword">implements</span> <span class="title">InitializingBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * logger instance</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(ProviderRouter<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> RpcProviderHandler rpcProviderHandler;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> CodecEncodeHandler codecEncodeHandler;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> RpcConfigServer rpcConfigServer;</span><br><span class="line">  <span class="keyword">private</span> EventLoopGroup master;</span><br><span class="line">  <span class="keyword">private</span> EventLoopGroup workers;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * start server for rpc provider</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@throws</span> Exception init failed</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    master = <span class="keyword">new</span> NioEventLoopGroup(<span class="number">1</span>);</span><br><span class="line">    workers = <span class="keyword">new</span> NioEventLoopGroup(<span class="number">10</span>);</span><br><span class="line">    RemoteAddr addr = RemoteAddr.local();</span><br><span class="line">    <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        ServerBootstrap server = <span class="keyword">new</span> ServerBootstrap();</span><br><span class="line">        server.group(master, workers)</span><br><span class="line">            .channel(NioServerSocketChannel<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">            .<span class="title">localAddress</span>(<span class="title">new</span> <span class="title">InetSocketAddress</span>(<span class="title">Integer</span>.<span class="title">parseInt</span>(<span class="title">addr</span>.<span class="title">getPort</span>())))</span></span><br><span class="line"><span class="class">            .<span class="title">childHandler</span>(<span class="title">new</span> <span class="title">ChannelInitializer</span>&lt;<span class="title">SocketChannel</span>&gt;() </span>&#123;</span><br><span class="line">              <span class="meta">@Override</span></span><br><span class="line">              <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                ch.pipeline()</span><br><span class="line">                    .addLast(<span class="string">"prepend"</span>, <span class="keyword">new</span> LengthFieldPrepender(<span class="number">2</span>))</span><br><span class="line">                    .addLast(<span class="string">"remove"</span>, <span class="keyword">new</span> LengthFieldBasedFrameDecoder(<span class="number">65536</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>))</span><br><span class="line">                    .addLast(<span class="string">"decoder"</span>, <span class="keyword">new</span> CodecDecodeHandler(rpcConfigServer.fetchCodec(),</span><br><span class="line">                        RpcRequest<span class="class">.<span class="keyword">class</span>))</span></span><br><span class="line">                    .addLast("encoder", codecEncodeHandler)</span><br><span class="line">                    .addLast(<span class="string">"rpc_provider"</span>, rpcProviderHandler);</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        ChannelFuture channelFuture = server.bind().sync();</span><br><span class="line">        LOGGER.info(RpcProviderHandler<span class="class">.<span class="keyword">class</span>.<span class="title">getName</span>() +</span></span><br><span class="line">            " started and listening for connections on " + channelFuture.channel().localAddress());</span><br><span class="line">        channelFuture.channel().closeFuture().sync();</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        master.shutdownGracefully();</span><br><span class="line">        workers.shutdownGracefully();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@PreDestroy</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    LOGGER.info(<span class="string">"server shutdown going..."</span>);</span><br><span class="line">    master.shutdownGracefully().sync();</span><br><span class="line">    workers.shutdownGracefully().sync();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>æ¶ˆè´¹ç«¯<ul>
<li>åˆ¤æ–­æ˜¯callèµ°è¿‘ç«¯è¿˜æ˜¯è¿œç«¯,åˆ›å»ºå¯¹åº”çš„proxyï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸”å¥‘åˆåˆ°springçš„lifecycleä¸­<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConsumerBeanPostProcessor</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span>,</span></span><br><span class="line"><span class="class">    <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * the app instance</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> ApplicationContext app;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * remote rpc services</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> Set&lt;String&gt; remoteServices = Sets.newHashSet();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * register consumer for class</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> targetName the instance name</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> inner      the inner class</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> Object <span class="title">createProxy</span><span class="params">(String targetName, Class&lt;?&gt; inner, ProviderType typo)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.app.containsBean(targetName) &amp;&amp; typo == ProviderType.LOCAL) &#123;</span><br><span class="line">      <span class="keyword">return</span> Proxy</span><br><span class="line">          .newProxyInstance(Thread.currentThread().getContextClassLoader(), <span class="keyword">new</span> Class[]&#123;inner&#125;,</span><br><span class="line">              <span class="keyword">new</span> LocalInvocationWrapper(targetName, inner));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> Proxy</span><br><span class="line">          .newProxyInstance(Thread.currentThread().getContextClassLoader(), <span class="keyword">new</span> Class[]&#123;inner&#125;,</span><br><span class="line">              <span class="keyword">new</span> RemoteInvocationWrapper(targetName, inner));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">    Class&lt;?&gt; target = bean.getClass();</span><br><span class="line">    <span class="keyword">for</span> (Field field : target.getDeclaredFields()) &#123;</span><br><span class="line">      <span class="comment">//inject consumer</span></span><br><span class="line">      <span class="keyword">if</span> (field.getAnnotation(Consumer<span class="class">.<span class="keyword">class</span>) !</span>= <span class="keyword">null</span> &amp;&amp; field.getType().isInterface()) &#123;</span><br><span class="line">        Consumer ann = field.getAnnotation(Consumer<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">        String name = ann.value();</span><br><span class="line">        String targetName =</span><br><span class="line">            StringUtils.isEmpty(name) ? StringUtils.uncapitalize(field.getType().getSimpleName())</span><br><span class="line">                : name;</span><br><span class="line">        <span class="keyword">if</span> (ann.typo() == ProviderType.REMOTE || !<span class="keyword">this</span>.app.containsBean(targetName)) &#123;</span><br><span class="line">          remoteServices.add(targetName);</span><br><span class="line">        &#125;</span><br><span class="line">        Object instance = <span class="keyword">this</span>.createProxy(targetName, field.getType(), ann.typo());</span><br><span class="line">        field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        ReflectionUtils.setField(field, bean, instance);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> bean;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.app = applicationContext;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * get all remote services</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> service set</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Set&lt;String&gt; <span class="title">getRemoteServices</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> remoteServices;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>è¯·æ±‚å¤„ç†ï¼Œæ­¤å¤„ä½¿ç”¨äº†ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ï¼Œé€šè¿‡é˜Ÿåˆ—çš„æ–¹å¼å¼‚æ­¥åŒ–ï¼Œå¢åŠ ååé‡ï¼Œå¯ä»¥åŸºäºæ­¤åšåˆ°æ§é€Ÿå’Œåå‹(backpush)<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RpcMsgPool</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  ExecutorService PROCESSORS = <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">5</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">      TimeUnit.MICROSECONDS, <span class="keyword">new</span> LinkedBlockingDeque&lt;&gt;(<span class="number">500</span>));</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">answer</span><span class="params">(RpcResponse response)</span></span>;</span><br><span class="line">  <span class="function">Future&lt;RpcResponse&gt; <span class="title">send</span><span class="params">(RpcRequest request)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AsyncRpcMsgPool</span> <span class="keyword">implements</span> <span class="title">RpcMsgPool</span>, <span class="title">InitializingBean</span>, <span class="title">DisposableBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> AsyncRpcMsgPool INSTANCE = <span class="keyword">new</span> AsyncRpcMsgPool();</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> BlockingQueue&lt;RpcRequest&gt; REQUEST_QUEUE = <span class="keyword">new</span> LinkedBlockingQueue&lt;&gt;(</span><br><span class="line">      <span class="number">10000</span>);</span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, RpcRequest&gt; REQUEST_MAP = Maps.newConcurrentMap();</span><br><span class="line">  <span class="keyword">protected</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, RpcResponse&gt; RESPONSE_POOL = Maps</span><br><span class="line">      .newConcurrentMap();</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(AsyncRpcMsgPool<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Lock held by take, poll, etc</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> ReentrantLock takeLock = <span class="keyword">new</span> ReentrantLock();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Wait queue for waiting takes</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">final</span> Condition updated = takeLock.newCondition();</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> stop = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> ConsumerRouter consumerRouter;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> AsyncRpcMsgPool <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> INSTANCE;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> RpcResponse <span class="title">fetch</span><span class="params">(String requestId)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">    takeLock.lockInterruptibly();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (!RESPONSE_POOL.containsKey(requestId)) &#123;</span><br><span class="line">        updated.await();</span><br><span class="line">      &#125;</span><br><span class="line">      RpcResponse response = RESPONSE_POOL.get(requestId);</span><br><span class="line">      RESPONSE_POOL.remove(requestId);</span><br><span class="line">      <span class="keyword">return</span> response;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      takeLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * fetch the specified response of request id</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> requestId the request id</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> the response</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> RpcResponse <span class="title">fetch</span><span class="params">(String requestId, <span class="keyword">long</span> timeout)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> InterruptedException, TimeoutException </span>&#123;</span><br><span class="line">    takeLock.lockInterruptibly();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">while</span> (!RESPONSE_POOL.containsKey(requestId)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!updated.await(timeout, TimeUnit.MILLISECONDS)) &#123;</span><br><span class="line">          <span class="keyword">throw</span> <span class="keyword">new</span> TimeoutException(<span class="string">"fetch result timeout!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      RpcResponse response = RESPONSE_POOL.get(requestId);</span><br><span class="line">      RESPONSE_POOL.remove(requestId);</span><br><span class="line">      REQUEST_MAP.remove(requestId);</span><br><span class="line">      <span class="keyword">return</span> response;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      takeLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * send requst to server</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> request the request info</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> the future of response</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Future&lt;RpcResponse&gt; <span class="title">send</span><span class="params">(RpcRequest request)</span> </span>&#123;</span><br><span class="line">    REQUEST_QUEUE.add(request);</span><br><span class="line">    REQUEST_MAP.put(request.getSessionId(), request);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> RpcFuture(request.getSessionId());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">answer</span><span class="params">(RpcResponse response)</span> </span>&#123;</span><br><span class="line">    RESPONSE_POOL.put(response.getId(), response);</span><br><span class="line">    signalNotEmpty();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> RpcRequest <span class="title">search</span><span class="params">(String sessionId)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> REQUEST_MAP.get(sessionId);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Signals a waiting take. Called only from put/offer (which do not otherwise ordinarily lock</span></span><br><span class="line"><span class="comment">   * takeLock.)</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">signalNotEmpty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> ReentrantLock takeLock = <span class="keyword">this</span>.takeLock;</span><br><span class="line">    takeLock.lock();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      updated.signalAll();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      takeLock.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    PROCESSORS.execute(() -&gt; &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (; ; ) &#123;</span><br><span class="line">          <span class="keyword">if</span> (stop) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          RpcRequest request = REQUEST_QUEUE.take();</span><br><span class="line">          consumerRouter.choose(request.getServiceId()).writeAndFlush(request);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        LOGGER.error(<span class="string">"this request fetch failed!"</span>, e);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    stop = <span class="keyword">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">RpcFuture</span> <span class="keyword">implements</span> <span class="title">Future</span>&lt;<span class="title">RpcResponse</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * the request id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String requestId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RpcFuture</span><span class="params">(String requestId)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.requestId = requestId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">cancel</span><span class="params">(<span class="keyword">boolean</span> mayInterruptIfRunning)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isCancelled</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isDone</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> AsyncRpcMsgPool.RESPONSE_POOL.containsKey(requestId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RpcResponse <span class="title">get</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> getInstance().fetch(requestId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RpcResponse <span class="title">get</span><span class="params">(<span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException </span>&#123;</span><br><span class="line">      <span class="keyword">long</span> to = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">switch</span> (unit) &#123;</span><br><span class="line">        <span class="keyword">case</span> DAYS:</span><br><span class="line">          to = TimeUnit.DAYS.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> HOURS:</span><br><span class="line">          to = TimeUnit.HOURS.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> MINUTES:</span><br><span class="line">          to = TimeUnit.MINUTES.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> SECONDS:</span><br><span class="line">          to = TimeUnit.SECONDS.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> MILLISECONDS:</span><br><span class="line">          to = TimeUnit.MILLISECONDS.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> MICROSECONDS:</span><br><span class="line">          to = TimeUnit.MICROSECONDS.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> NANOSECONDS:</span><br><span class="line">          to = TimeUnit.NANOSECONDS.toMillis(timeout);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> getInstance().fetch(requestId, to);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li>å·¥å…·ç±»<ul>
<li>encodingå·¥å…·ï¼Œå®ç°äº†jsonå’Œpbçš„åºåˆ—åŒ–,å› ä¸ºç½‘ç»œä¼ è¾“çš„éƒ½æ˜¯bytes<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CodecProcessor</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">RpcSerModel</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">byte</span>[] encode(T data);</span><br><span class="line">  <span class="function">T <span class="title">decode</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">JSONCodecProcessor</span> <span class="keyword">extends</span> <span class="title">CodecProcessor</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProtoCodecProcessor</span> <span class="keyword">extends</span> <span class="title">CodecProcessor</span></span>;</span><br></pre></td></tr></table></figure></li>
<li>idç”Ÿå·å™¨ï¼Œæ¯ä¸ªè¯·æ±‚ä¼šæœ‰å”¯ä¸€çš„æ ‡è¯†ï¼Œæˆ‘ä»¬é€šè¿‡çš„æ˜¯ç”Ÿå·å™¨å»è§£å†³è¿™ä¸ªé—®é¢˜,uuidå’Œsnowflakeä¸¤ç§ç®—æ³•<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Generator</span> </span>&#123;</span><br><span class="line">   <span class="function">String <span class="title">generateId</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UUIDGenerator</span> <span class="keyword">extends</span> <span class="title">Generator</span></span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SnowflakeGenerator</span> <span class="keyword">extends</span> <span class="title">Generator</span></span>;</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2>é€šè¿‡ä¸Šé¢ä¸€ç³»åˆ—çš„å·¥ä½œï¼Œæˆ‘ä»¬çš„ç®€æ˜“RPCæ¡†æ¶å°±å®Œæˆäº†ï¼Œå®è·µæ˜¯å­¦ä¹ å¾ˆå¥½çš„é€”å¾„ï¼Œæ¯ä¸ªäººåœ¨åšçš„è¿‡ç¨‹ä¸­ï¼Œä¼šæå‡ºä¸åŒçš„é—®é¢˜ï¼Œæœ‰ä¸åŒçš„åˆ›æ–°ï¼›<br>åˆ†äº«å‡ºæ¥æ˜¯å¾ˆå¥½çš„æˆé•¿ï¼</li>
</ul>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2019/07/09/write-a-easy-rpc/" data-id="ckf12d0er001ezgk0bmqi3vsp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/infra/" rel="tag">infra</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hexo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/24/hexo/" class="article-date">
  <time datetime="2017-01-24T09:24:00.000Z" itemprop="datePublished">2017-01-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Essay/">Essay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/24/hexo/">HEXO+GITHUBæ­å»ºä¸ªäººåšå®¢</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨githubä¸Šæ­å»º<a href="http://learn2pro.tech">åšå®¢</a>ä¸€èˆ¬ä½¿ç”¨Jekyll static blogsçš„æ–¹å¼ï¼Œéå¸¸æ–¹ä¾¿å¿«æ·ï¼Œä½†æ˜¯æœ‰ä¸ªç¼ºç‚¹ä¾¿æ˜¯åˆ‡æ¢themeå¾ˆä¸æ–¹ä¾¿ï¼›ç”¨Jekyllç›¸å¯¹æ™®é€šäººæ¥è¯´å·²ç»è¶³å¤Ÿï¼Œä½†æ˜¯å¦‚æœéœ€è¦å¼ºå¤§çš„æ¨¡ç‰ˆï¼Œä¸€äº›å¯æ‰©å±•çš„ä¸œè¥¿ï¼Œå°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦å¯¹å‰ç«¯æœ‰ä¸€å®šçš„æŠ€æœ¯èƒŒæ™¯ã€‚<br>æ‰€ä»¥å‡ºç°äº†</p>
<ul>
<li><p>Hexo :+1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">What is Hexo?Hexo is a fast, simple and powerful blog framework. You write posts in Markdown (or other languages) and Hexo generates static files with a beautiful theme in seconds.</span><br></pre></td></tr></table></figure>
<p>Hexo ï¼ Node.js + MarkDown<br>Hexoåˆ‡æ¢æ¨¡æ¿éå¸¸æ–¹ä¾¿åªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶é‡æ–°generateä¸€ä¸‹ï¼ŒHexoå®˜æ–¹æ–‡æ¡£<a href="https://hexo.io/docs/" target="_blank" rel="noopener">Document</a><br>å®‰è£…Hexoä¹‹å‰éœ€è¦å®‰è£…nodeå’Œgitï¼š</p>
<ul>
<li>Node.js</li>
<li>Git</li>
</ul>
</li>
</ul>
<p>å¦‚æœä½ çš„ç”µè„‘å·²ç»å®‰è£…å¥½äº†nodeå’Œgit,ä½¿ç”¨npmå®‰è£…ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure>
<p>ç„¶åå»æŒ‘é€‰å–œæ¬¢hexoæ¨¡æ¿<a href="https://hexo.io/themes/" target="_blank" rel="noopener">themes</a>å¼€å§‹æ­å»ºä¸ªäººåšå®¢äº†,æˆ–è€…githubä¸Šé¢æœç´¢hexo themesæœ‰å¾ˆå¤šé«˜starçš„æ¨¡æ¿ï¼Œ<a href="http://learn2pro.tech">æœ¬æ–‡çš„åšå®¢</a><br>é‡‡ç”¨çš„æ˜¯<a href="http://litten.me" target="_blank" rel="noopener">litten</a>,éå¸¸æ„Ÿè°¢;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir &lt;foldser&gt;</span><br><span class="line">$ hexo init &lt;folder&gt;</span><br><span class="line">$ <span class="built_in">cd</span> &lt;folder&gt;</span><br><span class="line">$ npm install</span><br><span class="line">å½“æˆ‘ä»¬åˆå§‹åŒ–å®Œæˆåæˆ‘ä»¬çš„ç›®å½•ç»“æ„å¦‚ä¸‹</span><br><span class="line">.</span><br><span class="line">â”œâ”€â”€ _config.yml</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ scaffolds</span><br><span class="line">â”œâ”€â”€ <span class="built_in">source</span></span><br><span class="line">|   â”œâ”€â”€ _drafts</span><br><span class="line">|   â””â”€â”€ _posts</span><br><span class="line">â””â”€â”€ themes</span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2017/01/24/hexo/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2017/01/24/hexo/" data-id="ckf12d0e70009zgk0hw0jaqpm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/default/" rel="tag">default</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-01-23-dl-algorithm-SVM" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/24/2017-01-23-dl-algorithm-SVM/" class="article-date">
  <time datetime="2017-01-24T03:06:43.000Z" itemprop="datePublished">2017-01-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/24/2017-01-23-dl-algorithm-SVM/">æ·±åº¦å­¦ä¹ -æœºå™¨å­¦ä¹ ç»å…¸ç®—æ³•</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>æœºå™¨å­¦ä¹ çš„ç®—æ³•ä¸»è¦åŒ…å«ç›‘ç£å­¦ä¹ å’Œéç›‘ç£å­¦ä¹ ä¸¤ä¸ªå¤§ç±»ï¼š</p>
<p>ç›‘ç£å­¦ä¹ ï¼šç®€å•çš„è¯´ä¾¿æ˜¯ï¼Œæ ·æœ¬é›†å¸¦æœ‰å±æ€§ï¼Œéœ€è¦æ ¹æ®æ ·æœ¬é›†åˆ¤æ–­æ–°çš„é‡‡æ ·ç‚¹çš„å±æ€§ï¼Œå¸¸è§çš„knnï¼Œsvm</p>
<p>éç›‘ç£å­¦ä¹ ï¼šä¸ç›‘ç£å­¦ä¹ ç›¸åï¼Œæ ·æœ¬é›†æ²¡æœ‰å±æ€§ä¿¡æ¯ï¼Œéœ€è¦åˆ’åˆ†å‡ºæ ·æœ¬é›†çš„åˆ†ç±»ï¼Œå¸¸è§k-means;</p>
<p>   K-means</p>
<p>k-means,kä»£è¡¨å°†è¦èšç±»å‡ºçš„kä¸ªclusterï¼Œç®—æ³•æµç¨‹ï¼š</p>
<p>1.éšæœºé€‰å‡ºæ ·æœ¬é›†Nä¸­kä¸ªé‡‡æ ·ç‚¹ä½œä¸ºclusterçš„ä¸­å¿ƒï¼›</p>
<p>2.æ ·æ¿é›†Nä¸­å…¶ä»–é‡‡æ ·ç‚¹é€‰å–ç¦»è‡ªå·±è·ç¦»æœ€è¿‘çš„kä¸ªcluster centerç‚¹ä½œä¸ºè‡ªå·±çš„ä¸­å¿ƒç‚¹ç„¶å</p>
<p>3.é€šè¿‡2æˆ‘ä»¬è·å¾—äº†kä¸ªclusterï¼Œæ¯ä¸ªclusteré‡Œé¢æœ‰å¾ˆå¤šç‚¹ï¼Œé€šè¿‡è¿™äº›ç‚¹ç®—å‡ºæ¯ä¸ªclusterçš„ä¸­å¿ƒç‚¹ï¼ˆç¦»ä¸­å¿ƒæœ€è¿‘çš„ç‚¹ï¼‰</p>
<p>4.é‡å¤2,3 ç›´åˆ°ç»“æœæ”¶æ•›</p>
<p>5.åœ¨æ­¤ç®—æ³•ä¸­æ¯”è¾ƒé‡è¦çš„æ˜¯è·ç¦»çš„è®¡ç®—ï¼Œæ ¹æ®ä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒçš„æ–¹å¼ï¼Œå¸¸ç”¨å‡ ç§è·ç¦»ï¼š</p>
<p>æ¬§å‡ é‡Œå¾—è·ç¦»ï¼ˆEuclidean Distanceï¼‰</p>
<p>æ¬§æ°è·ç¦»æ˜¯æœ€å¸¸è§çš„è·ç¦»åº¦é‡ï¼Œè¡¡é‡çš„æ˜¯å¤šç»´ç©ºé—´ä¸­å„ä¸ªç‚¹ä¹‹é—´çš„ç»å¯¹è·ç¦»ã€‚å…¬å¼å¦‚ä¸‹ï¼š</p>
<p><img src="/image/svm_pic/ou.png" alt=""></p>
        
          <p class="article-more-link">
            <a href="/2017/01/24/2017-01-23-dl-algorithm-SVM/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2017/01/24/2017-01-23-dl-algorithm-SVM/" data-id="ckf12d0e20004zgk0321w520z" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ML/" rel="tag">ML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SVM/" rel="tag">SVM</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-01-22-dl-demo-flabby-bird" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/23/2017-01-22-dl-demo-flabby-bird/" class="article-date">
  <time datetime="2017-01-23T11:06:00.000Z" itemprop="datePublished">2017-01-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/23/2017-01-22-dl-demo-flabby-bird/">æ·±åº¦å­¦ä¹ -CNNè®­ç»ƒFlabby bird  çªç ´ä¸€ä¸‡åˆ†</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/image/bird/bird.gif" alt=""></p>
<p>ç¯å¢ƒ opencv/mxnet/python</p>
<p>1.å®‰è£…opencv (ps:ç¼–è¯‘mxneté¦–å…ˆéœ€è¦cvåº“)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install cmake gcc gcc-c++</span><br></pre></td></tr></table></figure>
        
          <p class="article-more-link">
            <a href="/2017/01/23/2017-01-22-dl-demo-flabby-bird/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2017/01/23/2017-01-22-dl-demo-flabby-bird/" data-id="ckf12d0dm0000zgk0f04veb4d" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DEMO/" rel="tag">DEMO</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DL/" rel="tag">DL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-2017-01-23-dl-algorithm-CNN" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/23/2017-01-23-dl-algorithm-CNN/" class="article-date">
  <time datetime="2017-01-23T11:06:00.000Z" itemprop="datePublished">2017-01-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Technology/">Technology</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/23/2017-01-23-dl-algorithm-CNN/">æ·±åº¦å­¦ä¹ -åˆè¯†CNN</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨ä¸Šä¸€æ¬¡çš„æ–‡ç« birdå­¦ä¹ è·¯å¾„çš„è¿­ä»£åŸç†ä¾¿æ˜¯CNNç½‘ç»œï¼Œæœ¬æ–‡å°†ä»‹ç»Flabby-birdçš„æ•´ä¸ªå®ç°ç®—æ³•<br>æ¦‚è¿°</p>
<p><img src="/image/cnn/2.jpg" alt=""></p>
<p>å·ç§¯ç¥ç»ç½‘ç»œ(Convolutional Neural Network, CNN)æ˜¯æ·±åº¦å­¦ä¹ æŠ€æœ¯ä¸­æå…·ä»£è¡¨çš„ç½‘ç»œç»“æ„ä¹‹ä¸€ï¼Œåœ¨å›¾åƒå¤„ç†é¢†åŸŸå–å¾—äº†å¾ˆå¤§çš„æˆåŠŸï¼Œåœ¨å›½é™…æ ‡å‡†çš„ImageNetæ•°æ®é›†ä¸Šï¼Œè®¸å¤šæˆåŠŸçš„æ¨¡å‹éƒ½æ˜¯åŸºäºCNNçš„ã€‚CNNç›¸è¾ƒäºä¼ ç»Ÿçš„å›¾åƒå¤„ç†ç®—æ³•çš„ä¼˜ç‚¹ä¹‹ä¸€åœ¨äºï¼Œé¿å…äº†å¯¹å›¾åƒå¤æ‚çš„å‰æœŸé¢„å¤„ç†è¿‡ç¨‹ï¼ˆæå–äººå·¥ç‰¹å¾ç­‰ï¼‰ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥åŸå§‹å›¾åƒã€‚</p>
<p>å›¾åƒå¤„ç†ä¸­ï¼Œå¾€å¾€ä¼šå°†å›¾åƒçœ‹æˆæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªçš„äºŒç»´å‘é‡ï¼Œå¦‚ä¹‹å‰åšæ–‡ä¸­æåˆ°çš„MNISTæ‰‹å†™ä½“å›¾ç‰‡å°±å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ª28 Ã— 28çš„äºŒç»´å‘é‡ï¼ˆé»‘ç™½å›¾ç‰‡ï¼Œåªæœ‰ä¸€ä¸ªé¢œè‰²é€šé“ï¼›å¦‚æœæ˜¯RGBè¡¨ç¤ºçš„å½©è‰²å›¾ç‰‡åˆ™æœ‰ä¸‰ä¸ªé¢œè‰²é€šé“ï¼Œå¯è¡¨ç¤ºä¸ºä¸‰å¼ äºŒç»´å‘é‡ï¼‰ã€‚ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œéƒ½æ˜¯é‡‡ç”¨å…¨è¿æ¥çš„æ–¹å¼ï¼Œå³è¾“å…¥å±‚åˆ°éšè—å±‚çš„ç¥ç»å…ƒéƒ½æ˜¯å…¨éƒ¨è¿æ¥çš„ï¼Œè¿™æ ·åšå°†å¯¼è‡´å‚æ•°é‡å·¨å¤§ï¼Œä½¿å¾—ç½‘ç»œè®­ç»ƒè€—æ—¶ç”šè‡³éš¾ä»¥è®­ç»ƒï¼Œè€ŒCNNåˆ™é€šè¿‡å±€éƒ¨è¿æ¥ã€æƒå€¼å…±äº«ç­‰æ–¹æ³•é¿å…è¿™ä¸€å›°éš¾ï¼Œæœ‰è¶£çš„æ˜¯ï¼Œè¿™äº›æ–¹æ³•éƒ½æ˜¯å—åˆ°ç°ä»£ç”Ÿç‰©ç¥ç»ç½‘ç»œç›¸å…³ç ”ç©¶çš„å¯å‘ï¼ˆæ„Ÿå…´è¶£å¯é˜…è¯»ä»¥ä¸‹éƒ¨åˆ†ï¼‰ã€‚</p>
<p>ä¸‹é¢é‡ç‚¹ä»‹ç»ä¸‹CNNä¸­çš„å±€éƒ¨è¿æ¥(Sparse Connectivity)å’Œæƒå€¼å…±äº«(Shared Weights)æ–¹æ³•ï¼Œç†è§£å®ƒä»¬å¾ˆé‡è¦ã€‚<br>å±€éƒ¨è¿æ¥ä¸æƒå€¼å…±äº«</p>
<p>ä¸‹å›¾æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„å›¾ç¤ºï¼Œå·¦è¾¹æ˜¯å…¨è¿æ¥ï¼Œå³è¾¹æ˜¯å±€éƒ¨è¿æ¥ã€‚</p>
<p><img src="/image/cnn/6.jpg" alt=""></p>
        
          <p class="article-more-link">
            <a href="/2017/01/23/2017-01-23-dl-algorithm-CNN/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2017/01/23/2017-01-23-dl-algorithm-CNN/" data-id="ckf12d0dy0001zgk0h42x97qu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CNN/" rel="tag">CNN</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DL/" rel="tag">DL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/01/hello-world/" class="article-date">
  <time datetime="2017-01-01T09:24:00.000Z" itemprop="datePublished">2017-01-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Essay/">Essay</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/01/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://learn2pro.tech/2017/01/01/hello-world/" data-id="ckf12d0e40006zgk0gd7ic2kj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/default/" rel="tag">default</a></li></ul>

    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Essay/">Essay</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Technology/">Technology</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Algorithm/" rel="tag">Algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CNN/" rel="tag">CNN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DEMO/" rel="tag">DEMO</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DL/" rel="tag">DL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Infra/" rel="tag">Infra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ML/" rel="tag">ML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SVM/" rel="tag">SVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/default/" rel="tag">default</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/infra/" rel="tag">infra</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rpc/" rel="tag">rpc</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Algorithm/" style="font-size: 20px;">Algorithm</a> <a href="/tags/CNN/" style="font-size: 10px;">CNN</a> <a href="/tags/DEMO/" style="font-size: 10px;">DEMO</a> <a href="/tags/DL/" style="font-size: 13.33px;">DL</a> <a href="/tags/Infra/" style="font-size: 10px;">Infra</a> <a href="/tags/ML/" style="font-size: 10px;">ML</a> <a href="/tags/SVM/" style="font-size: 10px;">SVM</a> <a href="/tags/default/" style="font-size: 16.67px;">default</a> <a href="/tags/infra/" style="font-size: 10px;">infra</a> <a href="/tags/rpc/" style="font-size: 10px;">rpc</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/07/22/infra-design/">æˆ‘çœ¼ä¸­å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¯ç”¨ç³»ç»Ÿ</a>
          </li>
        
          <li>
            <a href="/2020/07/18/ali-learn/">Wonderful tour in alibaba</a>
          </li>
        
          <li>
            <a href="/2020/07/18/manachers-algorithm/">ä»€ä¹ˆæ˜¯é©¬æ‹‰è½¦(manacher&#39;s)ç®—æ³•</a>
          </li>
        
          <li>
            <a href="/2020/07/09/snowflake-alg/">è¯¦è§£é›ªèŠ±ç®—æ³•</a>
          </li>
        
          <li>
            <a href="/2019/07/09/write-a-easy-rpc/">Step by Stepå†™ä¸€ä¸ªç®€æ˜“çš„RPC</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 learn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>